{% extends 'base.html' %}

{% block title %}ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ - ìŠ¤ë§ˆíŠ¸ ì‚¬ì—…ì ê°€ê³„ë¶€{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-5 gap-3">
        <div>
            <h2 class="fw-bold text-dark mb-1">ğŸ› ï¸ ì¹´í…Œê³ ë¦¬ ê´€ë¦¬</h2>
            <p class="text-muted mb-0 small">ìˆ˜ì…ê³¼ ì§€ì¶œì„ ì„¸ë¶„í™”í•˜ë©´ ìš°ë¦¬ ê°€ê²Œ ëˆ íë¦„ì´ ì •í™•íˆ ë³´ì…ë‹ˆë‹¤.</p>
        </div>
        <a href="{% url 'transactions:category_create' %}" class="btn btn-primary px-4 py-2 fw-bold shadow-sm rounded-pill">
            <i class="bi bi-plus-circle-fill me-2"></i> ìƒˆ í•­ëª© ì¶”ê°€
        </a>
    </div>

<div class="bg-white p-2 rounded-4 mb-5 border shadow-sm">
        <ul class="nav nav-pills nav-justified gap-3 border-0" id="categoryTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active fw-bold py-3 border-0 transition-all custom-tab-btn expense-btn" 
                        id="expense-tab" data-bs-toggle="pill" data-bs-target="#expense-pane" 
                        type="button" role="tab">
                    ğŸ’¸ ì§€ì¶œ í•­ëª©
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link fw-bold py-3 border-0 transition-all custom-tab-btn income-btn" 
                        id="income-tab" data-bs-toggle="pill" data-bs-target="#income-pane" 
                        type="button" role="tab">
                    ğŸ’° ìˆ˜ì… í•­ëª©
                </button>
            </li>
        </ul>
    </div>

    <div class="tab-content" id="categoryTabContent">
        
        <div class="tab-pane fade show active" id="expense-pane" role="tabpanel">
            <div class="row g-3">
                {% for cat in categories %}
                    {% if cat.type == 'expense' %}
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 border-0 shadow-sm hover-up border-start border-4 {% if cat.is_system %}border-secondary-subtle{% else %}border-primary{% endif %}">
                            <div class="card-body p-3 d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    <div class="category-icon bg-danger-subtle text-danger me-3">
                                        {% if "ì‹" in cat.name %}<i class="bi bi-egg-fried"></i>
                                        {% elif "ì›”ì„¸" in cat.name or "ì„ì°¨" in cat.name %}<i class="bi bi-house-door"></i>
                                        {% elif "ê¸‰ì—¬" in cat.name or "ì•Œë°”" in cat.name %}<i class="bi bi-person-badge"></i>
                                        {% elif "ì°¨" in cat.name or "ìœ ë¥˜" in cat.name %}<i class="bi bi-truck"></i>
                                        {% elif "ê´‘ê³ " in cat.name or "í™ë³´" in cat.name %}<i class="bi bi-megaphone"></i>
                                        {% elif "í†µì‹ " in cat.name %}<i class="bi bi-telephone"></i>
                                        {% elif "ì„¸ê¸ˆ" in cat.name or "ê³µê³¼ê¸ˆ" in cat.name %}<i class="bi bi-receipt"></i>
                                        {% else %}<i class="bi bi-dash-circle"></i>{% endif %}
                                    </div>
                                    <div>
                                        <h6 class="fw-bold mb-0 text-dark">{{ cat.name }}</h6>
                                        <span class="text-muted small" style="font-size: 0.7rem;">{{ cat.get_expense_type_display|default:"ì¼ë°˜ë¹„ìš©" }}</span>
                                    </div>
                                </div>
                                {% if not cat.is_system %}
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-icon border-0" data-bs-toggle="dropdown"><i class="bi bi-three-dots-vertical"></i></button>
                                    <ul class="dropdown-menu dropdown-menu-end border-0 shadow">
                                        <li><a class="dropdown-item py-2" href="{% url 'transactions:category_update' cat.pk %}">ìˆ˜ì •</a></li>
                                        <li><a class="dropdown-item py-2 text-danger" href="{% url 'transactions:category_delete' cat.pk %}">ì‚­ì œ</a></li>
                                    </ul>
                                </div>
                                {% else %}<i class="bi bi-lock-fill text-black-50 small"></i>{% endif %}
                            </div>
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>

        <div class="tab-pane fade" id="income-pane" role="tabpanel">
            <div class="row g-3">
                {% for cat in categories %}
                    {% if cat.type == 'income' %}
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 border-0 shadow-sm hover-up border-start border-4 {% if cat.is_system %}border-secondary-subtle{% else %}border-success{% endif %}">
                            <div class="card-body p-3 d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    <div class="category-icon bg-success-subtle text-success me-3">
                                        {% if "ë§¤ì¶œ" in cat.name or "íŒë§¤" in cat.name %}<i class="bi bi-shop"></i>
                                        {% elif "ì§€ì›" in cat.name or "ë³´ì¡°ê¸ˆ" in cat.name %}<i class="bi bi-gift"></i>
                                        {% elif "ì´ì" in cat.name or "ë°°ë‹¹" in cat.name %}<i class="bi bi-bank"></i>
                                        {% elif "ê¸°íƒ€" in cat.name or "í™˜ê¸‰" in cat.name %}<i class="bi bi-arrow-repeat"></i>
                                        {% else %}<i class="bi bi-plus-circle-fill"></i>{% endif %}
                                    </div>
                                    <div>
                                        <h6 class="fw-bold mb-0 text-dark">{{ cat.name }}</h6>
                                        {% if "ë§¤ì¶œ" in cat.name %}
                                            <span class="badge bg-success-subtle text-success border-0 small" style="font-size: 0.65rem;">ì£¼ìˆ˜ì…</span>
                                        {% elif "ì´ì" in cat.name or "ì§€ì›" in cat.name %}
                                            <span class="badge bg-info-subtle text-info border-0 small" style="font-size: 0.65rem;">ì˜ì—…ì™¸ìˆ˜ì…</span>
                                        {% else %}
                                            <span class="badge bg-light text-secondary border-0 small" style="font-size: 0.65rem;">ì¼ë°˜ìˆ˜ì…</span>
                                        {% endif %}
                                    </div>
                                </div>
                                {% if not cat.is_system %}
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-icon border-0" data-bs-toggle="dropdown"><i class="bi bi-three-dots-vertical"></i></button>
                                    <ul class="dropdown-menu dropdown-menu-end border-0 shadow">
                                        <li><a class="dropdown-item py-2" href="{% url 'transactions:category_update' cat.pk %}">ìˆ˜ì •</a></li>
                                        <li><a class="dropdown-item py-2 text-danger" href="{% url 'transactions:category_delete' cat.pk %}">ì‚­ì œ</a></li>
                                    </ul>
                                </div>
                                {% else %}<i class="bi bi-lock-fill text-black-50 small"></i>{% endif %}
                            </div>
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<style>
    body { background-color: #f8f9fa; }
    .nav-pills .nav-link { color: #888; border-radius: 12px; }
    .nav-pills .nav-link.active { background-color: white !important; box-shadow: 0 4px 15px rgba(0,0,0,0.05); color: #0d6efd !important; }
    #income-tab.active { color: #198754 !important; }
    .hover-up { transition: 0.25s; }
    .hover-up:hover { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(0,0,0,0.08) !important; }
    .category-icon { width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; border-radius: 12px; font-size: 1.2rem; }
</style>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}