{% extends "base.html" %}

{% block title %}ì‚¬ì—…ì¥ ëª©ë¡ - ìŠ¤ë§ˆíŠ¸ ì‚¬ì—…ì ê°€ê³„ë¶€{% endblock %}

{% block top_nav %}
<div class="top-nav-links">
    <a href="{% url 'accounts:home' %}" class="nav-button">ëŒ€ì‹œë³´ë“œ</a>
    <span class="nav-divider">|</span>
    <a href="{% url 'transactions:transaction_list' %}" class="nav-button">ê±°ë˜ ê´€ë¦¬</a>
    <span class="nav-divider">|</span>
    <a href="{% url 'businesses:business_list' %}" class="nav-button active">ì‚¬ì—…ì¥ ê´€ë¦¬</a>
    <span class="nav-divider">|</span>
    <a href="{% url 'businesses:account_list' %}" class="nav-button">ê³„ì¢Œ ê´€ë¦¬</a>
    <span class="nav-divider">|</span>
    <a href="{% url 'accounts:profile_detail' %}" class="nav-button">í”„ë¡œí•„</a>
    {% if user.is_authenticated %}
    <span class="nav-divider">|</span>
    <span class="user-name">{{ user.username }}</span>
    <span class="nav-divider">|</span>
    <form method="post" action="{% url 'accounts:logout' %}" style="display:inline;">
        {% csrf_token %}
        <button type="submit" class="nav-button logout-btn" style="background:none;border:none;padding:0.5rem 1rem;">ë¡œê·¸ì•„ì›ƒ</button>
    </form>
    {% endif %}
</div>
{% endblock %}

{% block content %}
<div class="content-wrapper">
    <section class="welcome-section">
        <div class="welcome-header">
            <span class="welcome-icon">ğŸ¢</span>
            <h2 class="page-title">ì‚¬ì—…ì¥ ëª©ë¡</h2>
            <p class="description">ë“±ë¡ëœ ì‚¬ì—…ì¥ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

        <div class="cta-section" style="border: none; background: none; padding-bottom: 0;">
            <a href="{% url 'businesses:business_create' %}" class="btn btn-primary">+ ì‚¬ì—…ì¥ ì¶”ê°€</a>
        </div>

        <!-- í•„í„° -->
        <div class="welcome-message">
            <form method="get" style="display: flex; gap: 10px; margin-bottom: var(--spacing-md);">
                <select name="branch_type" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.95rem;">
                    <option value="" {% if not selected_branch_type %}selected{% endif %}>ì „ì²´</option>
                    <option value="main" {% if selected_branch_type == 'main' %}selected{% endif %}>ë³¸ì </option>
                    <option value="branch" {% if selected_branch_type == 'branch' %}selected{% endif %}>ì§€ì </option>
                </select>
                <select name="business_type" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.95rem;">
                    <option value="" {% if not selected_business_type %}selected{% endif %}>ì—…ì¢… ì „ì²´</option>
                    <option value="ì¹´í˜" {% if selected_business_type == 'ì¹´í˜' %}selected{% endif %}>ì¹´í˜</option>
                    <option value="ë¹¨ë˜ë°©" {% if selected_business_type == 'ë¹¨ë˜ë°©' %}selected{% endif %}>ë¹¨ë˜ë°©</option>
                    <option value="ìë™íŒë§¤ê¸°" {% if selected_business_type == 'ìë™íŒë§¤ê¸°' %}selected{% endif %}>ìë™íŒë§¤ê¸°</option>
                    <option value="ë¬´ì¸í¸ì˜ì " {% if selected_business_type == 'ë¬´ì¸í¸ì˜ì ' %}selected{% endif %}>ë¬´ì¸í¸ì˜ì </option>
                    <option value="ê¸°íƒ€" {% if selected_business_type == 'ê¸°íƒ€' %}selected{% endif %}>ê¸°íƒ€</option>
                </select>
                <button type="submit" class="btn btn-primary" style="padding: 8px 16px;">í•„í„°</button>
            </form>
        </div>

        <!-- ëª©ë¡ -->
        <div class="welcome-message">
            {% if businesses %}
            <div class="dashboard-container">
                <div class="summary-grid" style="grid-template-columns: 1fr;">
                    {% for business in businesses %}
                    <div class="summary-item">
                        <a href="{% url 'businesses:business_detail' business.pk %}" style="text-decoration: none; color: inherit; width: 100%; display: block;">
                            <span class="summary-label">
                                {{ business.name }}
                                <span style="font-size: 0.8rem; color: {% if business.branch_type == 'main' %}#27ae60{% else %}#3498db{% endif %}; margin-left: 8px;">
                                    [{{ business.get_branch_type_display }}]
                                </span>
                            </span>
                            <span class="summary-value">{{ business.location|default:"ìœ„ì¹˜ ë¯¸ë“±ë¡" }} Â· {{ business.business_type|default:"ì—…ì¢… ë¯¸ë“±ë¡" }}</span>
                        </a>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% else %}
            <p class="description">ë“±ë¡ëœ ì‚¬ì—…ì¥ì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆ ì‚¬ì—…ì¥ì„ ì¶”ê°€í•´ë³´ì„¸ìš”!</p>
            {% endif %}
        </div>
    </section>
</div>
{% endblock %}